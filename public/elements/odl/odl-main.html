<link rel="import" href="../../components/paper-styles/paper-styles.html">
<link rel="import" href="../../components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="../../components/paper-input/paper-textarea.html">
<link rel="import" href="../../components/paper-toast/paper-toast.html">
<link rel="import" href="../../components/paper-checkbox/paper-checkbox.html">

<link rel="import" href="../../components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../components/iron-ajax/iron-ajax.html">

<link rel="import" href="../../components/paper-material/paper-material.html">
<link rel="import" href="../../components/iron-pages/iron-pages.html">
<link rel="import" href="top-nav.html">
<link rel="import" href="side-nav.html">
<link rel="import" href="odl-theme.html">

<link rel="import" href="../../components/carbon-route/carbon-route.html">
<link rel="import" href="../../components/carbon-route/carbon-location.html">

<link rel="import" href="../../components/i18-n/i18-n.html">

<link rel="import" href="../dialogs/help-dialog.html">
<link rel="import" href="../controls/loading-spinner.html">
<link rel="import" href="../controls/lazy-loader.html">

<link rel="import" href="../../components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../../components/neon-animation/neon-animations.html">

<link rel="import" href="../behaviors/odl-behavior.html">
<link rel="import" href="../active-tutorial/odl-tutorial.html">
<script src="../../js/jquery_mobile/jquery.mobile.custom.min.js"></script>

<dom-module id="odl-main">
    <template>
        <i18-n-domain id="domain" on-i18-n-locale-ready="_localeReady" locale="{{lang}}" messages-url="public/translations-autogenerated"></i18-n-domain>

        <odl-tutorial lang="{{lang}}"
                      t="{{t}}" id="tutorial" disabled="{{tutorialDisabled}}"
                      lhm-selected-name="{{lhmSelectedName}}" lhm-list-selected-name="{{lhmListSelectedName}}"
                      selected-name="{{selectedName}}" contacts="{{contacts}}"
                      cars="{{cars}}" drivers="{{drivers}}" devices="{{devices}}"
                      syncs="{{syncs}}" user="{{user}}"
        ></odl-tutorial>
        <carbon-location route="{{route}}"></carbon-location>
        <carbon-route active="{{tail.active}}" id="mainRoute"
                      data="{{routeParams}}" route="{{route}}" pattern="{{_getOdlRoot(route.path)}}/:selectedName" tail="{{tail}}"></carbon-route>

        <style is="custom-style" include="odl-styles"></style>
        <style>
            .mobile #topNav {
                display:none;
            }
        </style>
        <div class="flex"><loading-spinner id="spinner" loading="{{loading}}"></loading-spinner> </div>
        <div class$="odl-primary vertical layout fit [[ifTrue(isMobile,'mobile','desktop')]]">
            <div id="topPanel" hidden$="[[_isSame(routeParams.selectedName,'lhm',isMobile,1)]]">
                <div class="odl-secondary horizontal layout nopadding flex">
                    <div class="pad3px"><paper-icon-button id="toggleDrawer" icon="menu" on-tap="toggleDrawer"></paper-icon-button></div>
                    <div class="horizontal layout flex-1"> <!-- TODO LOGO Automagisch --></div>
                    <div id="topNav" class="horizontal layout flex-9">
                        <top-nav  class$="flex right [[ifTrue(isMobile,'mobile','desktop')]]" menuitems="{{topNavItems}}"></top-nav>
                    </div>
                </div>
            </div>
            <div class="flex vertical layout">
                <paper-drawer-panel id="mainDrawerPanel" disable-swipe disable-edge-swipe style="position:relative;"  responsive-width="850px" force-narrow="[[isMobile]]" class$="white flex [[ifTrue(isMobile,'mobile','desktop')]]">
                    <div id="mainDrawer" class="vertical layout" style="overflow:auto;" drawer>
                        <div class="flex" style="overflow:auto;">
                            <side-nav is-mobile="[[isMobile]]" id="side-nav" menuitems="{{menuitems}}" style="padding-left:10px;"> </side-nav>
                            <paper-menu class="icon">
                                <paper-item label="Impressum" on-tap="showImpressum" id="link_impressum" style="cursor:pointer;">
                                    <iron-icon icon="favorite" style="color: red;"> </iron-icon> <span style="padding-left:5px;">Impressum</span>
                                </paper-item>
                            </paper-menu>
                            <div style="text-align:right;">
                                <small> Â© 2015 Copyright Automagisch</small>
                            </div>
                        </div>
                    </div>
                    <div id="mainPanel" class="flex vertical layout" style="overflow:auto;padding-left:5px;" main>
                        <div class="odl-primary vertical layout flex">
                            <neon-animated-pages entry-animation="fade-in-animation" exit-animation="fade-out-animation" class="fit"
                                                 selected="{{routeParams.selectedName}}"
                                                 attr-for-selected="name"
                                                 selected-item="{{selectedPage}}"
                                                 id="mainSlider"
                                                 entry-animation="fade-in-animation"
                                                 exit-animation="fade-out-animation">
                                <lazy-loader class="fit" href="../pages/page-login.html"
                                             name="login" >
                                    <page-login is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'login')]]"
                                                id="login" lang="{{lang}}" route="{{tail}}"
                                                on-new-nav-functions="_onNewNavFunctions"
                                                class="fit scroll"></page-login>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-reset-password.html"
                                             name="resetPassword" >
                                    <page-reset-password is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'resetPassword')]]" id="resetPassword" lang="{{lang}}" route="{{tail}}"
                                                         on-new-nav-functions="_onNewNavFunctions"
                                                         class="fit scroll"></page-reset-password>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-new-password.html"
                                             name="newPassword" >
                                    <page-new-password is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'newPassword')]]" id="newPassword" lang="{{lang}}" route="{{tail}}"
                                                       on-new-nav-functions="_onNewNavFunctions"
                                                       class="fit scroll"></page-new-password>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-register.html" name="register">
                                    <page-register is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'register')]]" id="register" lang="{{lang}}" route="{{tail}}"
                                                   on-new-nav-functions="_onNewNavFunctions"
                                                   class="fit scroll"></page-register>
                                </lazy-loader>
                                <!-- <neon-animatable id="loginprefill" name="loginprefill">
                                <page-login lang="{{lang}}" on-new-nav-functions="_onNewNavFunctions" class="fit scroll" user="{{params.user}}"></page-login>
                                </neon-animatable> -->
                                <lazy-loader class="fit" href="../pages/page-welcome.html" name="welcome">
                                    <page-welcome is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'welcome')]]" id="welcome"  lang="{{lang}}" route="{{tail}}"
                                                  on-new-nav-functions="_onNewNavFunctions"
                                                  class="fit scroll"></page-welcome>
                                </lazy-loader>
                                <lazy-loader href="../pages/page-lhm.html"
                                             class="fit" name="lhm" >
                                    <page-lhm is-mobile="[[isMobile]]" on-toggle-drawer="toggleDrawer" is-active="[[_isSame(routeParams.selectedName,'lhm')]]" contacts="{{contacts}}" list-selected-name="{{lhmListSelectedName}}"
                                              test='{"alt":"json", "q":"chrome"}' lang="{{lang}}" id="lhm"
                                              syncs="{{syncs}}" drivers="{{drivers}}" cars="{{cars}}"
                                              devices="{{devices}}" route="{{tail}}"
                                              on-new-nav-functions="_onNewNavFunctions" lhm-selected-name="{{lhmSelectedName}}"></page-lhm>

                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-upload.html" name="upload">
                                    <page-upload is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'upload')]]" id="upload" lang="{{lang}}" route="{{tail}}"
                                                 on-new-nav-functions="_onNewNavFunctions"
                                                 class="fit scroll"></page-upload>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-settings.html"
                                             name="settings">
                                    <page-settings is-mobile="[[isMobile]]"
                                                   is-active="[[_isSame(routeParams.selectedName,'settings')]]"
                                                   lang="{{lang}}" id="settings" route="{{tail}}"
                                                   on-new-nav-functions="_onNewNavFunctions" class="fit scroll">
                                    </page-settings>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-beta-man.html" name="betaMan">
                                    <page-beta-man is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'betaMan')]]" id="betaMan"  lang="{{lang}}" route="{{tail}}"
                                                   on-new-nav-functions="_onNewNavFunctions"
                                                   class="fit scroll"></page-beta-man></lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-invite.html" name="invite">
                                    <page-invite is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'invite')]]" id="invite" lang="{{lang}}" route="{{tail}}"
                                                 on-new-nav-functions="_onNewNavFunctions"
                                                 class="fit scroll"></page-invite>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-impressum.html" name="impressum">
                                    <page-impressum is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'impressum')]]" id="impressum"  lang="{{lang}}" route="{{tail}}"
                                                    on-new-nav-functions="_onNewNavFunctions"
                                                    class="fit scroll"></page-impressum>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-user-man.html" name="usrMan">
                                    <page-user-man is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'usrMan')]]" id="usrMan" lang="{{lang}}" route="{{tail}}"
                                                   on-new-nav-functions="_onNewNavFunctions"
                                                   class="fit scroll"></page-user-man>
                                </lazy-loader>
                                <lazy-loader class="fit" href="../pages/page-key-man.html" name="keyMan">
                                    <page-key-man is-mobile="[[isMobile]]" is-active="[[_isSame(routeParams.selectedName,'keyMan')]]" id="keyMan" lang="{{lang}}" route="{{tail}}"
                                                  on-new-nav-functions="_onNewNavFunctions"
                                                  class="fit scroll"></page-key-man>
                                </lazy-loader>
                            </neon-animated-pages>

                            <help-dialog style="display:none;" class="error" id="error" title="[[t.error]]!">
                                <p id="eb" >
                                </p>
                            </help-dialog>
                            <help-dialog style="display:none;" class="warning" id="warning" title="[[t.Oops]]!">
                                <p id="wb" ></p>
                            </help-dialog>
                            <help-dialog style="display:none;" class="statusMessage" id="status" title="[[t.status]]">
                                <p id="sb" ></p>
                            </help-dialog>
                            <paper-dialog id="reportErrorDialog" modal role="dialog" tabindex="-1" aria-modal="false" aria-hidden="true" style="z-index:1337;display: none;">
                                <div class="modal-content" id="errorReporter">
                                    <form id="error_form" class="">
                                        <h2>Fehlerbericht erstellen</h2>
                                        <div class="vertical layout" style="position:relative;">
                                            <paper-textarea style="padding-bottom:20px;" id="reportErrorTextArea" id="error_text" label="[[t.report_error_textarea]]" class="flex" autofocus></paper-textarea>
                                            <div class="buttons ">
                                                <paper-checkbox style="padding-right:40px;" checked id="sendMetaData" name="sendMetaData">[[t.SendMetaData]]</paper-checkbox>
                                                <paper-tooltip for="sendMetaData" margin-top="0">[[t.SendMetaDataDesc]]</paper-tooltip>

                                                <paper-button class="waves-effect btn amber darken-2 valign" dialog-dismiss id="error_report_cancel">[[t.Cancel]]</paper-button><br/><br/>
                                                <paper-button on-tap="submitErrorReport" id="error_report_submit" class="waves-effect btn amber darken-2 valign" dialog-confirm>[[t.report_error_submit]]</paper-button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </paper-dialog>


                        </div>
                    </div>

                </paper-drawer-panel>
            </div>
        </div>
        <div id="test" params='{"alt":"json", "q":"chrome"}'></div>
        <paper-toast id="thanksToast"><span id="label" class="style-scope paper-toast">[[t.thanks]]</span></paper-toast>
        <paper-toast id="toast"><span id="label" class="style-scope paper-toast">[[toastText]]</span></paper-toast>

        <help-dialog id="helpOverlay" style="" aria-hidden="true">

        </help-dialog>
    </template>
    <script>
        // https://github.com/webcomponents/webcomponentsjs/issues/49
        //$.mobile.changePage.defaults.changeHash = false;
        var isApp;
        if(isApp===undefined)
            isApp = false;
        var main;
        function load(tag) {
            main.load(tag);
        }
        function unload(tag) {
            main.unload(tag);
        }
        function showToast(text,t) {
            text = getTransMsg(text,t);
            main.toastText = text;
            main.$.toast.show();
        }
        var isMobile = false;
        Polymer({
            is: "odl-main",
            behaviors:[OdlBehaviors.OdlBehavior],
            properties: {
                menuitems: {
                    type:Array
                },topNavItems: {
                    type:Array,
                    value:[]
                },
                contacts: {
                    type:Object
                },
                cars: {
                    type:Object
                },
                drivers: {
                    type:Object
                },
                devices: {
                    type:Object
                },
                syncs: {
                    type:Object
                },
                sub1: {
                    type:String,
                    value:""
                },
                sub2: {
                    type:String,
                    value:""
                },
                sub3: {
                    type:String,
                    value:""
                },
                drawerCollapsed: {
                    type: Boolean,
                    value:false
                },
                selectedPage: {
                    type:Number,
                    observer:"_selectedPageChanged"
                },loadingStack: {
                    type: Array,
                    notify: true,
                    value: function() {
                        return [];
                    }
                },
                lhmSelectedName: {
                    type:String
                },
                lhmListSelectedName: {
                    type:String
                },
                loading: {
                    type:Boolean,
                    value:false
                },
                user: {
                    type:Object,
                    value:undefined,
                    observer:"initUser"
                }, tutorialDisabled : {
                    type:Number,
                    value:2
                },
                ajaxUri: String,
                subdirToReplace: String,
                isMobile : {
                    type:Object,
                    value: function() {
                        var isMobile = window.matchMedia("only screen"); //  and (max-width: 760px)
                        return isMobile.matches && $.mobile.support.touch;
                    },
                    observer:"_isMobileChanged"
                }
            },
            observers: [
                "_selectedNameChanged(routeParams.selectedName)"
            ],
            _isMobileChanged: function(i) {
                isMobile = i;
            },
            _isSame: function() {
                if(arguments.length !== 0) {
                    var match = true;
                    for(var i=1;i<arguments.length;i+=2) {
                        if(arguments[i-1]!=arguments[i]) {
                            match = false;
                            break;
                        }
                    }
                    return match;
                }
                else {
                    return false;
                }
            },
            _getOdlRoot: function(path) {
                if (path) {
                    var r = path.substring(0,path.indexOf("/odl/")+1)+"odl";
                    console.log("R IS " + r);
                    return r;
                } else {
                    return "I/WILL/NEVEREVER/MATCH"
                }
            },
            initUser:function() {
                if(this.user) {
                    this.user.TutorialDisabled = this.user.TutorialDisabled===true||this.user.TutorialDisabled>0;
                    this.user.NotificationsEnabled = this.user.NotificationsEnabled===true||this.user.NotificationsEnabled>0;

                } else if(isApp) {
                    setRoute("login");
                }
            },
            _appAjaxInited: function(resp,req) {
                debugger;
            },
            _selectedNameChanged: function(newVal) {
                var that = this;
                console.log("selectedNameChanged",newVal);
                window.setTimeout(function(){
                    if(!that.user && newVal && notLoggedInPages.indexOf(newVal)==-1) {
                        setRoute("/login");
                        window.setTimeout(function(){
                            if(!that.user && newVal && notLoggedInPages.indexOf(newVal)==-1)
                                setRoute("/login");
                        },500);
                    }
                    if(that.user && !that.user.TutorialDisabled) {
                        that.tutorialDisabled = false;
                    }
                    if(that.user && document.location.href.indexOf("odl"+that.urlFor("login"))!=-1) {
                        setRoute("/lhm/trips");
                    }
                },500);
                if(!newVal) {

                    var that = this;
                    window.setTimeout(function(){
                        if(that.routeParams.selectedName == "" || that.routeParams.selectedName==undefined) {
                            if(that.user) {
                                setRoute("/lhm/trips");
                            } else {
                                setRoute("/login");
                            }
                        }
                    },3000)
                }
            },
            ready: function() {
                this.drawerCollapsed = this.$.mainDrawerPanel.narrow;
                this.lang="de";
                main = this;
                // TODO : Find a good way to redirect people if not logged in
                /* if(!this.user && document.location.href!=this.urlFor("login")&&document.location.href!=this.urlFor("resetPassword")&&document.location.href!=this.urlFor("register")) {
                 document.location.href=this.urlFor("login");
                 }*/

            },
            submitErrorReport: function() {
                submitErrorReport();
            },
            _selectedPageChanged:function(newVal) {
                if(newVal) {
                    var nav = $("#navmenu_"+this.routeParams.selectedName)[0];
                    if(nav!==undefined) {
                        this.async(function(){
                            nav.close();
                        });
                    }
                    var that = this;
                    var els;
                    if(newVal.tagName.toLowerCase()=="lazy-loader") {
                        els = [newVal]
                    } else {
                        els = newVal.querySelectorAll("lazy-loader");
                    }
                    var renderPage = function() {
                        if ($("#loadFinished").length==0)
                            $('body').append('<span id="loadFinished" style="display:none;"></span>');
                        $.each(els,function(i,lazy){
                            var t = newVal.tagName+i;
                            load(t);
                            var wasLoadedBefore = lazy.loaded;
                            lazy.load(function(el){
                                //el.addEventListener("new-nav-functions",that._onNewNavFunctions);
                                that._onNewNavFunctions({srcElement: el});
                                if(el && el.initFunc && typeof(el.initFunc)=="function") {
                                    el.initFunc(wasLoadedBefore);
                                    if(wasLoadedBefore) {
                                        var nav = $("#navmenu_"+that.routeParams.selectedName)[0];
                                        if(nav!==undefined) {
                                            that.async(function(){
                                                nav.open();
                                            });

                                        }
                                    }
                                }
                                unload(t);
                            });

                        })
                    };
                    if(this.routeParams.selectedName=="lhm") { // call automatic sync stuff first
                        var syncUri = "./syncMan";
                        if(main.ajaxUri) {
                            syncUri = main.ajaxUri + "/syncMan"
                        }
                        $.ajax({
                                    url: syncUri,
                                    data:{action:"autoRefresh"}
                                }
                        ).done(function() {
                            renderPage();
                        })
                    } else {
                        renderPage();
                    }

                }
            },
            _onNewNavFunctions:function(e) {
                var nav = $("#navmenu_"+this.routeParams.selectedName)[0];
                if(nav==undefined) return;
                if(e && !e.srcElement && e.currentTarget) {
                    e.srcElement = e.currentTarget;
                }
                if(e && e.srcElement && this.menuitems  && e.srcElement.lazyLoader && ((this.selectedPage && this.selectedPage == e.srcElement.lazyLoader) || this.routeParams.selectedName==e.srcElement.lazyLoader.getAttribute("name"))) {

                    nav.close();
                    var newItems=[];
                    if(e.srcElement.navFunctions) {
                        $.each(e.srcElement.navFunctions,function(i,v){
                            newItems.push(v);
                        });

                    }
                    newItems.push({key:'showHelp',title: this.t["Help"], icon: 'help-outline', onTap:this.showHelp});
                    var idx = -1;
                    var n = this.routeParams.selectedName;
                    $.each(this.menuitems[0].items,function(i,v) {
                        if(v.key==n) {
                            idx = i;
                            return;
                        }
                    });
                    if(idx!==-1) {
                        this.set("menuitems.0.items."+idx+".subitems",newItems);
                    }
                    var m = this.menuitems[0].items[idx].subitems;
                    this.set("menuitems.0.items."+idx+".subitems",[]);
                    this.async(function(){
                        this.set("menuitems.0.items."+idx+".subitems",m);
                        nav.open();
                    });
                } else {
                    //console.warn("on new nav functions finished & not set!");

                }
                this.async(function(){
                    nav.open();
                });
            },
            showHelp:function(e,f,target) {
                main.$.helpOverlay.set("title",main.t["Help"]);
                if(main.selectedPage === undefined || main.selectedPage.children[0].children[0].helpText===undefined || main.selectedPage.children[0].children[0].helpText=="Unknown") {
                    Polymer.dom(main.$.helpOverlay).innerHTML = main.t["missingHelp"];
                } else {
                    Polymer.dom(main.$.helpOverlay).innerHTML = main.selectedPage.children[0].children[0].helpText;
                }
                main.$.helpOverlay.open();
            },
            _onTranslationUpdate:function(t) {
                if(!t) return;

                // allow html in language files
                Polymer.dom(this.$.reportErrorTextArea).innerHTML = this.t["report_error_textarea"];
                var defaultSubMenu = [ {key:'showHelp',title: this.t["Help"], icon: 'help-outline', onTap:this.showHelp}
                ];
                this.menuitems= [
                    { groupName:"Navigation",
                        items: [
                            {key:'login',title: this.t["Login"], icon: 'add-circle', href: this.urlFor('login')},
                            {key:'register',title: this.t["Register"], icon: 'face', href: this.urlFor('register',{inviteKey:"123"})},
                        ]}
                ];

                if(this.user) {
                    this.menuitems[0].items = [
                        {key:'lhm',title: this.t["Management central"], icon: 'flag', href: this.urlFor('lhm/trips'),subitems:defaultSubMenu},
                        {key:'upload',title: this.t["Import data"], icon: 'file-upload', href: this.urlFor('upload'),subitems:defaultSubMenu},
                        {key:'welcome',title: this.t["Show welcome"], icon: 'home', href: this.urlFor('welcome'),subitems:defaultSubMenu},
                        {key:'settings',title: this.t["Settings"], icon: 'settings', href: this.urlFor('settings'),subitems:defaultSubMenu},
                        {key:'nav_report_error',title: this.t["report error"], icon: 'bug-report', href:'javascript:reportError();'},
                        {key:'logout',title: this.t["Logout"], icon: 'exit-to-app', href: './logout',subitems:defaultSubMenu}];

                    if (this.user.Level==1337) {
                        this.menuitems[0].items.push({key:'usrMan',title: this.t["UserManager"], icon: 'account-box', href: this.urlFor('usrMan'),subitems:defaultSubMenu});
                        this.menuitems[0].items.push({key:'keyMan',title: this.t["KeyManager"], icon: 'build', href: this.urlFor('keyMan'),subitems:defaultSubMenu});

                        this.menuitems[0].items.push({key:'betaMan',title: this.t["BetaManager"], icon: 'face', href: this.urlFor('betaMan/sendMail'),subitems:defaultSubMenu});
                        this.menuitems[0].items.push({key:'invite',title: this.t["New invitekey"], icon: 'add', href: this.urlFor('invite'),subitems:defaultSubMenu});
                    }
                    this.topNavItems = [this.menuitems[0]];

                }
                this.topNavItems = [this.menuitems[0]];

            },
            showImpressum: function() {
                setRoute("/impressum");
            },
            toggleDrawer: function() {
                console.log("main toggledrawer")
                var d = this.$.mainDrawerPanel;
                if (d.narrow) {
                    if (this.drawerCollapsed) {
                        d.drawerWidth = "250px;";
                        this.drawerCollapsed = false;

                    }

                    d.togglePanel();
                    var m = this.map;

                } else {
                    if (!this.drawerCollapsed) {
                        d.drawerWidth = "0px;";
                        this.drawerCollapsed = true;
                    } else {
                        d.drawerWidth = "250px;";
                        this.drawerCollapsed = false;
                    }

                }
            },
            load: function(tag) {
                this.$.spinner.addLoader(tag);
            },
            unload: function(tag) {
                this.$.spinner.removeLoader(tag);
            }

        });
    </script>
</dom-module>