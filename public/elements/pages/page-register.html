<link rel="import" href="../../elements/odl/odl-theme.html">
<link rel="import" href="../../elements/behaviors/odl-behavior.html">

<link rel="import" href="../../components/i18-n/i18-n.html">
<link rel="import" href="../../components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../elements/behaviors/odl-verifybehavior.html">
<link rel="import" href="../../elements/controls/password-security-bar.html">
<link rel="import" href="../../elements/edits/user-edit.html">

<script src="../../components/travist/jsencrypt/bin/jsencrypt.min.js"></script>

<dom-module id="page-register">
    <template>
        <carbon-route route="{{route}}" pattern="/:inviteKey" data="{{routeParams}}"></carbon-route>

        <i18-n-domain id="domain2" on-i18-n-locale-ready="_localeReady" domain="login" locale="{{lang}}"  messages-url="public/translations-autogenerated"></i18-n-domain>
        <i18-n-domain id="domain3" on-i18-n-locale-ready="_localeReady" domain="register" locale="{{lang}}"  messages-url="public/translations-autogenerated"></i18-n-domain>
        <style include="odl-styles"></style>

        <div class="vertical layout">
            <paper-card>
                <user-edit invite-key="{{inviteKey}}" is-register="true" title="Registrieren" id="uEdit" t="{{t}}" user="{{user}}"></user-edit>
            </paper-card>
        </div>
    </template>
    <script>
        Polymer({
            is: "page-register",
            behaviors:[OdlBehaviors.OdlBehavior,
                OdlBehaviors.OdlVerifyBehavior],
            properties: {
                inviteKey:{type:String, value:undefined, observer:"_inviteKeyChanged",computed:'_getSame(routeParams.inviteKey)'}
            },
            _getSame: function(e) {
                return e;
            },
            ready:function() {
                this.user = this.$.uEdit.getNew();
            },
            getHelpText: function(){
                if(this.t && this.t.helpText_register) {
                    return this.t.helpText_register;
                } else {
                    return "Unknown";
                }
            },
            _onTranslationUpdate:function(t) {
                if(this.t) {
                    this.navFunctions=[
                        //{key:'Function',title: this.t["Function"], icon: 'dns', href:'javascript:alert("Implement me!"'}
                    ];
                    this.fire("new-nav-functions");


                }
            },
            _inviteKeyChanged: function() {
                if(!this.inviteKey || this.inviteKey=="123") {
                    showError(this.t.inviteOnly);
                } else {
                    hideError();
                }
            }
        });

    </script>


</dom-module>